pipeline {
    agent any

    parameters {
        choice(
            name: 'ROLE',
            choices: [
                'postgre_install',
                'postgre_remote',
                'postgre_backup',
                'postgre_db',
                'postgre_restore',
                'postgre_users'
            ],
            description: 'Выберите Ansible роль'
        )
    }

    stages {
        stage('Run Selected Role') {
            steps {
                script {
                    echo "Выбрана роль: ${params.ROLE}"

                    // Запуск дочернего Jenkinsfile
                    build job: "roles/${params.ROLE}",
                           propagate: true,
                           wait: true
                }
            }
        }
    }
}
